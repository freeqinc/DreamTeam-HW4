<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="description" content="bullion management site, rare coins, gold, silver, platinum">
    <meta name="author" content="CSE134B Dream Team">
    <link rel="stylesheet" type="text/css" href="./style/style.css">
    <meta name=viewport content="width=device-width, initial-scale=.8, minimum-scale = .8, user-scalable=yes">
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    <script src="https://cdn.firebase.com/js/simple-login/1.6.1/firebase-simple-login.js"></script>
    <script src="./js/jquery-1.11.2.min.js"></script>
    <script src="./js/velocity.min.js"></script>
    <!--<script src="./js/main.js"></script>-->
    <title>Sandbox</title>
</head>

<body>
    <input type='text' id='nameInput' placeholder='Name'>
    <a href="" id="login">Login</a>
    <div id="list">
    </div>
    <script>
    var fb = new Firebase('https://134b-dreamteam.firebaseio.com/');
    var usersRef = fb.child("users");
    var dataCalled = false;

    usersRef.on("value", function(data) {
        for (var key in data.val()) {
            if (data.val().hasOwnProperty(key) && !dataCalled) {
                string = "<div>" + data.val()[key]["name"] + "</div>"
                $("#list").append(string);
            }
        }
        dataCalled = true;
    });

    $("#login").click(function() {
        fb.authWithOAuthPopup("google", function(error, authData) {
            if (error) {
                console.log("Login Failed!", error);
            } else {
                console.log("Authenticated successfully with payload:", authData);
            }
        });
    });

    $('#nameInput').keypress(function(e) {
        if (e.keyCode == 13) {
            var name = $('#nameInput').val();
            /*usersRef.set({
                someone: {
                    name: name,
                    text: text
                }
            });*/
            //usersRef.child("someone").update({});
            usersRef.push({
                name: name
            });
            string = "<div>" + name + "</div>"
            $("#list").append(string);
            $('#nameInput').val('');
        }
    });
    </script>
</body>

</html>
